# 用户分群

## [1.简介](/docs/~/drafts/-LGi3GvtKCxrvxZGFSsh/primary/data-analytics/user-segmentation#1-jian-jie)​ {#1-jian-jie}

用户分群，是指通过一定的规则找到对应的用户群体。 常用的方法包括：

* 找到做过某些事情的人群：比如过去7天完成过3次购物车计算
* 有某些特定属性的人群：比如年龄在25岁以下的男性
* 在转化过程中流失的人群：比如提交了订单但没有付款

您可以根据自己要解决的业务问题，来定义关注的用户群体，还可以在GrowingIO平台中通过将分群套用在事件分析等各个分析工具中进一步分析；或者通过对这部分人群进行运营。

## ​[2.功能介绍](/docs/~/drafts/-LGi3GvtKCxrvxZGFSsh/primary/data-analytics/user-segmentation#2-1)​ {#2-1}

### ​[2.1分群列表](/docs/~/drafts/-LGi3GvtKCxrvxZGFSsh/primary/data-analytics/user-segmentation#2-1-1)​ {#2-1-1}

1. 分群列表分成3个tab，“我的”，“订阅”和“全部”。分别是我自己创建的分群，我订阅的分群和我有查看权限的全部分群。如果您还没有创建过分群或者整个项目中其他用户也没有创建过分群，会引导您新建一个分群。
2. 排序方式：默认排序方式是“按更新时间由近及远排序”，代表按照分群条件最后一次编辑保存的时间由近及远来排序。还支持按照“更新时间”由远及近排序以及支持按照“分群名称的首字母从A到Z”或者从“Z到A”排序。排序是为了更快地浏览和查找目标分群，如果您项目中的分群数量较多，您可以通过搜索来更快地查找。
3. 搜索：支持按照分群名称或创建人搜索，支持模糊匹配。我们支持对搜索匹配做了优化，可以帮助您更高效地定位到目标分群。

   **分群下载**

   **下载权限**

   分群的下载受到权限控制，如果您没有权限下载某个分群，会看到分群按钮是不可用地状态，hover时提示您没有分群地下载权限。如果您想要下载该该分群，可以向分群创建者申请权限。

   **分群ID类型**

   ​![](https://docs.growingio.com/segmentation_v2/%20%E9%80%89%E6%8B%A9%E7%94%A8%E6%88%B7%20ID%E7%B1%BB%E5%9E%8B.png)​

每个分群都是基于特定的ID类型得到的：登录用户ID 或 访问用户ID。如何判断您创建的分群是哪种ID类型？

1. 通过漏斗或者留存下钻创建的分群：会继承对应漏斗或留存的用户ID类型
2. 规则创建的分群：创建时选择的用户ID类型
3. 上传登录用户ID得到的分群：登录用户ID类型

需要注意，我们暂时不支持“访问用户ID”类型创建的分群，原因是访问用户ID的标记方式是GrowingIO对每个访客按照浏览器cookie或移动设备的设备号映射得到一个随机的唯一ID，这个ID本身没有业务意义，仅用来做访客标识。后续我们会支持访问用户ID的下载并提供访问用户ID和可识别设备标记方式对应关系，比如IDFV, IDFA等。

### ​[2.2创建分群](/docs/~/drafts/-LGi3GvtKCxrvxZGFSsh/primary/data-analytics/user-segmentation#2-2)​ {#2-2}

#### 规则创建 {#规则创建}

规则创建，顾名思义是指通过一定的规则来创建出一个目标分群。由列表页的“新建分群”入口进入分群新建页面，即可开始创建一个新的分群。步骤如下：

**1. 选择ID类型**

访问用户：前面已经提到，访问用户ID是GrowingIO随时生成的唯一ID，如果你想要分的是析产品所有访客，可以选择“访问用户”； 登录用户：如果您想要分析的是登陆用户的行为，比如登录用户的跨屏购买等行为，可以选择“登录用户”； 能否选择“登录用户”，取决于您的项目中是否上传过用户属性字段；如果有上传，那么您可以选择“访问用户”或者“登录用户”类型；如果项目中没有上传过用户属性字段，那么只能选择“访问用户”类型。[用户属性的作用及如何上传？](https://docs.growingio.com/sdk-integration/sdk-1.x-docs/customer-attributes/)​

**2. 针对业务目标，选择分群条件**

您可以根据用户的属性和行为来定位目标用户。用户有什么样的固有属性和行为特征，决定了用户是谁；在用户分群中，您可以通过 "用户做过/没做过"来筛选用户行为；通过 "用户是/不是"来筛选用户属性；

**用户做过/没做过**

当您进入规则创建分群页面时，默认的第一条规则是: "用户做过 访问 &gt;= 1次 过去7天" 意思是在过去7天，有过至少一次访问的用户。

**选择 "用户做过/没做过"时，可以用来度量用户行为的事件包括：**

* 无埋点圈选事件、
* 埋点事件
* 3个预置的事件：访问、页面浏览量和活跃天数
  * 访问：从⽤户进⼊⽹站的⼀个⻚⾯开始，即访问开始，直到 web ⽹站 30 分钟内没有操作，或 app 端 30 秒没有操作，记为⼀次访问结束;
  * 页面浏览量：用户每浏览一次页面，页面浏览量+1；
  * 活跃天数: 如果用户在某一天发生过至少一次访问，即算作当天活跃；如果用户在一周时间内有3天发生过至少一次访问，那么一周内的活跃天数就是3；

**对事件的过滤**

选择 "用户做过"某个事件时，可以进一步通过过滤条件来限定该事件发生的特定条件。可以用来过滤事件的维度包括：您在项目中上传的自定义用户属性；GrowingIO SDK 默认采集的访问相关的维度包括设备信息，地域信息，用户来源（包括广告渠道），页面维度；以及通过埋点上传的各种变量。 比如，可以在第一条默认规则上过滤叫条件 "浏览器 = chrome"；意思是在过去7天，至少用 chrome 浏览器访问过一次的用户。![](https://docs.growingio.com/segmentation_v2/%E4%BA%8B%E4%BB%B6%E7%9A%84%E8%BF%87%E6%BB%A4.png)

**用户是/不是**

选择"用户是/不是"，可以通过用户属性来定位目标用户。可以选择的维度包括您在项目中上传的自定义用户属性；GrowingIO SDK 默认采集的访问相关的维度包括设备信息，用户来源（包括广告渠道），地域信息等。比如，选择 "用户是 访问来源 = 直接访问 过去7天"，代表的是过去7天，曾经通过直接访问来到产品的用户。![](https://docs.growingio.com/segmentation_v2/%E7%94%A8%E6%88%B7%E6%98%AF.png)

**时间范围选择**

时间控件红选择 \(起始日期，结束日期\)；其中，"起始日期"最早可选择到的日期是当前项目的接入日期，"结束日期"最近时间可以选择到昨天。同时，结束日期和起始日期之间的时间间隔最多可以选择62天，也就是说您可以观测一个时间长度小于等于62天的一个用户群体。

**不同条件的连接**

我们提供了 "条件组"的概念，一个条件组内可以用 OR 连接5个不同的条件；不同的条件组之间用 AND 连接，也可以将 AND 切换成 OR。![](https://docs.growingio.com/segmentation_v2/%E6%9D%A1%E4%BB%B6%E7%BB%84%E5%92%8C%E6%9D%A1%E4%BB%B6.png)

**分群条件数量上限**

最多添加10个条件组； 每个条件组多支持添加你10个条件； 合计一共50个条件。

**3. 根据分群条件实时反馈用户数量和占比**

在您创建分群的过程中，每次修改一个分群条件，包括：修改一个分群条件，新增一个分群条件，删除一个分群条件；右侧可视化区域都会实时反馈分群人数的变化和比率 。比率的的计算方法是：当前分群条件下计算的人数/第一个分群条件对应的日期范围，有过访问的全部用户。 根据用户 ID类型是"登录用户 ID"还是"访问用户 ID"，计算比率时分母取相应的访问用户量或登录用户量。![](https://docs.growingio.com/segmentation_v2/%E5%88%86%E7%BE%A4%E4%BA%BA%E6%95%B0%E5%8F%AF%E8%A7%86%E5%8C%96.png)

**4. 保存分群，设定分群名称和权限**

点击"保存"，在控件中输入名称，设置权限后完成保存。 需要注意的是，此处会对分群名称做校验，包括重复命名，名称为空等一些异常情况。其中，重命名校验是在整个项目范围内进行的；您可能没有创建过相同名称的分群，但您所在的项目已经存在了该名称分群。![](https://docs.growingio.com/segmentation_v2/%E4%BF%9D%E5%AD%98%E5%88%86%E7%BE%A4%E6%8E%A7%E4%BB%B6.png)

#### 上传登陆用户ID {#上传登陆用户id}

您可能遇到过这样的场景：

1. 通过第三方系统举办了一场线上公开课，希望追踪报名并且参加了课程的用户后续在产品中的转化和使用情况。
2. 希望用 GrowingIO 分析一批核心用户的行为，这些核心用户是根据系统中用户的历史购买数据来定义的；但是不想把这些核心交易数据上传给 GrowingIO。

这样的情况下如何可以在 GrowingIO 构建出目标用户分群以便分析这些用户在产品中的行为呢？就可以通过 "上传登录用户 ID" 的方式。

**1. 入口及是否可用**

分群列表页可以看到"上传登录用户 ID" 入口，需要注意的是，是否可以上传受到2个因素的限制：

1. 项目中是否配置了用户变量，如果没有配置，则无法上传，具体参考[说明](https://docs.growingio.com/sdk-integration/sdk-2.x-docs/custom-data-implement-guide.html#%E7%94%A8%E6%88%B7%E5%8F%98%E9%87%8F%E9%85%8D%E7%BD%AE%EF%BC%9A)；

![](https://docs.growingio.com/segmentation_v2/%E4%B8%8A%E4%BC%A0%E7%99%BB%E5%BD%95%E7%94%A8%E6%88%B7%20ID%20%EF%BC%88%E6%B2%A1%E6%9C%89%20CS1%EF%BC%89.png)![](https://docs.growingio.com/segmentation_v2/%E4%B8%8A%E4%BC%A0%E7%99%BB%E5%BD%95%E7%94%A8%E6%88%B7%E5%85%A5%E5%8F%A3%EF%BC%88%E6%9C%89CS1%EF%BC%89.png)

**2. 上传限制**

1. 目前只支持 .csv 格式文件
2. 文件大小不超过 1M
3. 仅支持登录用户ID上传，用户 ID 放在第一列，有多列时只取第一列
4. 第一行是标题行，从第二行开始录入用户 ID，最多支持上传一万行登录用户ID数据（超过一万行时只保留前一万行）

#### 漏斗下钻 {#漏斗下钻}

我们在漏斗分析中提供了一键创建分群的功能，可以快速定位转化和未转化（流失）用户，打通分析到运营环节。鼠标点击在柱状视图即可出现以下效果。当前钻取有2个限制条件需要注意：

1. 当前仅支持您保存之后进行钻取
2. 钻取创建分群受到用户分群模块权限限制，如果您没有用户分群权限，将无法钻取创建分群。

![](https://docs.growingio.com/.gitbook/assets/lou-dou-yi-jian-chuang-jian-fen-qun.png)

#### 留存下钻 {#留存下钻}

参考留存帮助文档中的[说明](https://docs.growingio.com/analytics-tools/cohort-analysis.html#%E7%95%99%E5%AD%98%E4%B8%8B%E9%92%BB%E5%88%B0%E5%88%86%E7%BE%A4)​

### 2.3分群计算和使用 {#分群计算和使用}

#### 分群的计算 {#分群的计算}

分群会在每天凌晨触发计算，如果计算失败，您可以在分群列表中手动触发重新计算。

#### 分群的使用 {#分群的使用}

对于创建好的分群，当前有以下的使用去向：

* 下载用户列表（如果是登录用户 ID 类型）
* 进入用户细查
* 套用在各个分析工具中进行分析

### 2.4分群API {#2-4}

分群 API 参考 [API 文档](https://docs.growingio.com/api/reporting-api.html#%E5%88%86%E7%BE%A4-api-%E5%AE%9A%E4%B9%89)​

### 2.5编辑分群 {#编辑分群}

您可以通过编辑按钮进入分群修改页面；您可以修改分群名称和分群规则，并进行保存。

### 2.6权限控制 {#权限控制}

分群中提供了针对分群功能的权限控制和每个分群资源的权限控制；包括：

1. 分群模块权限：如果管理员将您的整个分群模块禁用，您在导航中不会看到"用户分群"入口
2. 新建分群权限：如果管理员没有分配您新建分群权限，您在分群列表看到的"创建分群" 和 "上传登录用户 ID" 都会被禁用，并在您尝试点击时提示您没有新建分群权限
3. 某个分群资源的权限：上面提到，保存分群时您可以设置该分群的权限，用户是否有权使用当前分群，以及可以如何使用该分群收到您设置的权限控制。同样地，您是否可以查看、编辑、分享、删除某个分群，也受到该分群创建者对您的权限分配。

## 3.统计口径 {#统计口径}

### 3.1用户ID类型 {#用户id类型}

访问用户：前面已经提到，访问用户ID是GrowingIO随时生成的唯一ID，如果你想要分的是析产品所有访客，可以选择“访问用户”； 登录用户：如果您想要分析的是登陆用户的行为，比如登录用户的跨屏购买等行为，可以选择“登录用户”； 能否选择“登录用户”，取决于您的项目中是否上传过用户属性字段；如果有上传，那么您可以选择“访问用户”或者“登录用户”类型；如果项目中没有上传过用户属性字段，那么只能选择“访问用户”类型。[用户属性的作用及如何上传？](https://docs.growingio.com/sdk-integration/sdk-1.x-docs/customer-attributes/)​

#### 登录用户 {#登录用户}

选择 "登录用户"，用户的计算会依托 "登录用户 ID"进行。比如一个注册用户 A过去7天分别在 iOS 和 Android 客户端分别观看过1次视频，合计视频观看次数=2 。当用分群条件 "用户做过 观看视频 &gt;=2 次 过去7天" 这个条件筛选时，就会定位到该用户A。

#### 访问用户 {#访问用户}

由于"访问用户" 的标识是不会跨平台的。同样还是上面的例子，如果选择了"访问用户"；当我们用分群条件 "用户做过 观看视频 &gt;=2 次 过去7天" 这个条件筛选时，不会定位到用户 A \(的 iOS 设备\)，因为iOS 上只观看过一次视频。

### 3.2"用户是" {#用户是}

"用户是 维度 = 维度值1 时间范围"（条件1）。 前面提到了可用的维度包括了您在项目中上传的自定义用户属性；GrowingIO SDK 默认采集的访问相关的维度包括设备信息，用户来源（包括广告渠道），地域信息等。 值的注意的是，条件1中的维度和维度值1的理解。举例来说，当我们用 SDK 默认采集的"城市"维度来查找用户时，分群条件设置为 "用户是 城市 = 北京 过去7天"，代表的含义是过去7天，从北京发起过访问的用户。反之，这些用户过去7天在北京有过访问，也可能在其他城市有过访问。

### 3.3"用户做过" {#用户做过}

这里值得注意的是，选择自定义打点事件时，这里只支持"计数器"类型，暂时不支持其他类型的数据。

## 4.常见问题 {#4}

**1. 上传登陆用户ID列表时，我上传了500个用户，为什么实际上得到的用户数量小于500？**

A: 上传的用户列表会跟 GrowingIO 历史上收到过的所有登录用户 ID 进行匹配，GrowingIO 会将匹配不到的数据扔掉，导致实际用户数量小于上传文件中的数据。可能出现的GrowingIO 会将可能的原因包括：

* 上传的用户列表中出现个别异常数据，比如某个 ID出现了多余的空格；
* 识别用户列表时会将第一行识别为标题行，如果您将 ID 录入在了第一行，会被忽略
* 如果某个老用户在您接入 GrowingIO 之后没有登录后，GrowingIO； 并没有收到过该用户 ID，您上传该用户 ID 时也会被忽略；
* 最多支持上传1w 条数据，超出1w 条的部分会被抛弃。

**2. 为什么“访问用户”创建分群不支持下载，只能下载“登陆用户”分群？**

A: 我们暂时不支持“访问用户ID”类型创建的分群，原因是访问用户ID的标记方式是GrowingIO对每个访客按照浏览器cookie或移动设备的设备号映射得到一个随机的唯一ID，这个ID本身没有业务意义，仅用来做访客标识。后续我们会支持访问用户ID的下载并提供访问用户ID和可识别设备标记方式对应关系，比如IDFV, IDFA等。

**2. 以下两种情况下统计口径是否有区别，如何理解？**

> A: 将"浏览器=chrome 过去7天" AND "用户做过 事件 A &gt;=1 次 过去7天" B: "用户做过 事件 A &gt;=1 次 过去7天" 过滤条件是 "浏览器=chrome"

A 代表的意思是，用户在过去7天曾经通过 chrome 浏览器访问过，并且，用户在过去7天至少做过一次事件 A。（这里不关心事件 A 是否是通过 chrome 浏览器触发的）

B 代表的意思是，用户在过去7天至少做过一次事件 A，并且事件 A 是通过 chrome 浏览器触发的。

